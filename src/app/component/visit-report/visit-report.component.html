<div class="container-lg mb-3">
  <h1>Relatório de Visitas</h1>

  <div *ngIf="filteredVisits && filteredVisits.length > 0; else noData" class="mb-3">
    <div style="display: flex; justify-content: space-between;">
      <div>
        <mat-form-field *ngIf="this.cargo === 'Gerente' || this.cargo === 'Diretor Executivo'">
          <mat-label>Selecione um vendedor</mat-label>
          <mat-select [(ngModel)]="selectedName" name="name" (selectionChange)="filterVisitsByName()">
            <mat-option value="">Selecione um vendedor</mat-option>
            <mat-option *ngFor="let name of names" [value]="name">
              {{ name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Selecione um Cliente</mat-label>
          <mat-select [(ngModel)]="selectedCliente" name="name" (selectionChange)="filterVisistByCliente()">
            <mat-option value="">Selecione um cliente</mat-option>
            <mat-option *ngFor="let client of clients" [value]="client">
              {{ client }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- <mat-form-field >
          <mat-label>Selecione um Cliente</mat-label>
          <mat-select [(ngModel)]="selectedCliente" name="name" (selectionChange)="filterVisistByCliente()">
            <mat-option value="">Selecione um cliente</mat-option>
            <mat-option *ngFor="let client of clients" [value]="client">
              {{ client }}
            </mat-option>
          </mat-select>
        </mat-form-field> -->


      </div>
      <div>
        <button class="btn btn-danger" (click)="clearFilter()">Limpar Filtro</button>
      </div>
    </div>

    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
      <ng-container matColumnDef="nome">
        <th mat-header-cell *matHeaderCellDef>Nome</th>
        <td mat-cell *matCellDef="let visit">{{ visit.NOME }} {{ visit.SOBRENOME }}</td>
      </ng-container>

      <ng-container matColumnDef="dataVisita">
        <th mat-header-cell *matHeaderCellDef (click)="sortByDate()">
          Data da Visita
          <mat-icon *ngIf="sortDirection === 'asc'">arrow_upward</mat-icon>
          <mat-icon *ngIf="sortDirection === 'desc'">arrow_downward</mat-icon>
        </th>
        <td mat-cell *matCellDef="let visit">{{ visit.DATA_VISITA | date: 'dd/MM/yyyy' }}</td>
      </ng-container>
      <ng-container matColumnDef="cliente">
        <th mat-header-cell *matHeaderCellDef>Cliente</th>
        <td mat-cell *matCellDef="let visit">{{ visit.CLIENTE }}</td>
      </ng-container>

      <ng-container matColumnDef="detalhes">
        <th mat-header-cell *matHeaderCellDef>Detalhes</th>
        <td mat-cell *matCellDef="let visit">
          <button class="btn btn-primary" (click)="showDetails(visit)">Detalhes</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>





  </div>

  <ng-template #noData>
    <div class="no-data-message">Não há visitas</div>
  </ng-template>
</div>
